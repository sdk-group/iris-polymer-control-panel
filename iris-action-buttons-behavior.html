<script>
  (function() {
    'use strict'

    window.IrisBehaviors = window.IrisBehaviors || {};

    IrisBehaviors.ActionButtonsBehvior = {
      getActionName(str) {
        let name = _.upperFirst(_.camelCase(str));
        return `action${name}`
      },
      actionNext(ticket) {
        return this.$.workstation.getNext();
      },
      actionCallAgain(ticket) {
        return ticket.callAgain().finally(() => this.$.viewer.restoreButtonsState());
      },
      actionRoute(ticket) {
        let mock_routs = {
          'service-1': ['pc-1', 'pc-2', 'pc-3'],
          'service-2': ['pc-1', 'pc-2', 'pc-3'],
          'service-3': ['pc-1', 'pc-2', 'pc-3'],
          'service-11': ['pc-1', 'pc-2', 'pc-3'],
          'service-21': ['pc-1', 'pc-2', 'pc-3'],
          'service-31': ['pc-1', 'pc-2', 'pc-3'],
          'service-12': ['pc-1', 'pc-2', 'pc-3'],
          'service-22': ['pc-1', 'pc-2', 'pc-3'],
          'service-32': ['pc-1', 'pc-2', 'pc-3'],
          'service-13': ['pc-1', 'pc-2', 'pc-3'],
          'service-23': ['pc-1', 'pc-2', 'pc-3'],
          'service-33': ['pc-1', 'pc-2', 'pc-3'],
          'service-14': ['pc-1', 'pc-2', 'pc-3'],
          'service-24': ['pc-1', 'pc-2', 'pc-3'],
          'service-34': ['pc-1', 'pc-2', 'pc-3'],
          'service-15': ['pc-1', 'pc-2', 'pc-3'],
          'service-25': ['pc-1', 'pc-2', 'pc-3'],
          'service-35': ['pc-1', 'pc-2', 'pc-3'],
          'service-16': ['pc-1', 'pc-2', 'pc-3'],
          'service-26': ['pc-1', 'pc-2', 'pc-3'],
          'service-36': ['pc-1', 'pc-2', 'pc-3'],
          'service-17': ['pc-1', 'pc-2', 'pc-3'],
          'service-27': ['pc-1', 'pc-2', 'pc-3'],
          'service-37': ['pc-1', 'pc-2', 'pc-3'],
          'service-18': ['pc-1', 'pc-2', 'pc-3'],
          'service-28': ['pc-1', 'pc-2', 'pc-3'],
          'service-38': ['pc-1', 'pc-2', 'pc-3'],
          'service-19': ['pc-1', 'pc-2', 'pc-3'],
          'service-29': ['pc-1', 'pc-2', 'pc-3'],
          'service-39': ['pc-1', 'pc-2', 'pc-3'],
          'service-10': ['pc-1', 'pc-2', 'pc-3'],
          'service-20': ['pc-1', 'pc-2', 'pc-3'],
          'service-30': ['pc-1', 'pc-2', 'pc-3'],
          'service-4': ['pc-1', 'pc-2', 'pc-3']
        };
        let mock_ticket = {
          service: 'service-4'
        };
        let requestRouts = Promise.resolve(mock_routs).delay(200);

        return requestRouts.then((routs) => {
          return this.$.routing.show(routs, mock_ticket)
        }).then((route) => {
          if (!route) return false;

          //NOTE@: MOCK!          
          return console.log('Routing to:', route);

          return this.$.workstation.routeTicket(ticket, route);
        }).finally(() => this.$.viewer.restoreButtonsState());
      },
      actionProcess(ticket) {
        return this.$.workstation.getTicketById(ticket);
      },
      actionPostpone(ticket) {
        return this.$.workstation.postponeTicket(ticket);
      },
      actionDefault(ticket, action) {
        return this.$.workstation.performTicketAction(ticket, action);
      },
      doAction(ticket, action) {
        let name = this.getActionName(action);
        return _.isFunction(this[name]) ? this[name](ticket) : this.actionDefault(ticket, action)
      }
    };

  })();
</script>
